# ‚õ™ Church Database Bot v2.0

–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏—Ö–æ–∂–∞–Ω —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Google Sheets, Telegram Mini App –∏ AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º Gemini.

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üì± –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **Telegram Bot**: –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –ø–æ–∏—Å–∫—É, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –∏ —Å–æ–∑–¥–∞–Ω–∏—é –∫–∞—Ä—Ç–æ—á–µ–∫ —á–µ—Ä–µ–∑ —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.
- **Telegram Mini App**: –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ Telegram –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.
- **Google Sheets**: –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ–±–ª–∞–∫–µ, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä—É—á–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

### üîç –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏
- **–ê–ª—Ñ–∞–≤–∏—Ç–Ω—ã–π –ø–æ–∏—Å–∫**: –£–¥–æ–±–Ω—ã–π –ø–æ–∏—Å–∫ –ª—é–¥–µ–π –ø–æ –ø–µ—Ä–≤–æ–π –±—É–∫–≤–µ –∏–º–µ–Ω–∏.
- **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –î–æ–º–∞—à–∫–∞–º**: –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–æ–≤ –ø—Ä–∏—Ö–æ–∂–∞–Ω, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø–æ –¥–æ–º–∞—à–Ω–∏–º –≥—Ä—É–ø–ø–∞–º.
- **–ö–∞–ª–µ–Ω–¥–∞—Ä—å –î–Ω–µ–π –†–æ–∂–¥–µ–Ω–∏—è**: –ü—Ä–æ—Å–º–æ—Ç—Ä –∏–º–µ–Ω–∏–Ω–Ω–∏–∫–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ä–∞—Å—á–µ—Ç–æ–º –≤–æ–∑—Ä–∞—Å—Ç–∞.
- **–ú—É–ª—å—Ç–∏–º–µ–¥–∏–∞**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏.
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π –¥–∞–Ω–Ω—ã—Ö –ø—Ä—è–º–æ —á–µ—Ä–µ–∑ –±–æ—Ç–∞.
- **–£–¥–∞–ª–µ–Ω–∏–µ**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–¥–∞–ª–µ–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π, –∫–∞—Ç–µ–≥–æ—Ä–∏–π (–∫–æ–ª–æ–Ω–æ–∫) –∏ –∑–∞–ø–∏—Å–µ–π –æ –ª—é–¥—è—Ö.

### ü§ñ AI –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç (Gemini)
- **–£–º–Ω—ã–π –ø–æ–∏—Å–∫**: –ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ö—Ç–æ —Ä–æ–¥–∏–ª—Å—è –≤ –º–∞–µ?", "–°–∫–æ–ª—å–∫–æ —á–µ–ª–æ–≤–µ–∫ —Å—Ç–∞—Ä—à–µ 30 –ª–µ—Ç?").
- **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞**: AI –º–æ–∂–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å—é —Ç–∞–±–ª–∏—Ü—É –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –∫—Ä–∞—Ç–∫–∏–µ —Å–≤–æ–¥–∫–∏ –∏–ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.

### üõ°Ô∏è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **–ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫**: –î–æ—Å—Ç—É–ø –∫ –±–æ—Ç—É –∏–º–µ—é—Ç —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏.
- **–£—Ä–æ–≤–Ω–∏ –¥–æ—Å—Ç—É–ø–∞**: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤.
- **–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: –£–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Å–º–µ–Ω—ã —Ä–æ–ª–µ–π.
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: 
  - `AccessLog`: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É.
  - `ActionLog`: –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π (–∫—Ç–æ, –∫–æ–≥–¥–∞ –∏ –∫–∞–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–Ω–µ—Å).
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å Google API —á–µ—Ä–µ–∑ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—ã—Å–æ–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç–∫–ª–∏–∫–∞.

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- **Backend**: Python 3.10+, FastAPI
- **Bot**: python-telegram-bot (v20+)
- **AI**: Google Generative AI (Gemini 1.5 Pro/Flash)
- **Database**: Google Sheets API (gspread)
- **Frontend**: HTML5, JavaScript (–¥–ª—è Mini App)
- **Deployment**: Docker, Docker Compose

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**:
   ```bash
   git clone <repository_url>
   cd bot_v2
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**:
   –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–º–µ—Ä–∞:
   ```env
   TELEGRAM_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
   SHEET_ID=id_–≥—É–≥–ª_—Ç–∞–±–ª–∏—Ü—ã
   MAIN_ADMIN_ID=–≤–∞—à_—Ç–µ–ª–µ–≥—Ä–∞–º_id
   GOOGLE_API_KEY=–≤–∞—à_–∫–ª—é—á_gemini
   WEBAPP_URL=https://–≤–∞—à-–¥–æ–º–µ–Ω.com
   ```

3. **Google API**:
   - –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Google Cloud Console.
   - –í–∫–ª—é—á–∏—Ç–µ Google Sheets API –∏ Google Drive API.
   - –°–æ–∑–¥–∞–π—Ç–µ Service Account, —Å–∫–∞—á–∞–π—Ç–µ JSON-–∫–ª—é—á –∏ –ø–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –µ–≥–æ –≤ `credentials.json` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞.
   - –î–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø –≤–∞—à–µ–º—É Service Account (email –∏–∑ JSON) –∫ –≤–∞—à–µ–π Google –¢–∞–±–ª–∏—Ü–µ.

4. **–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker**:
   ```bash
   docker-compose up -d --build
   ```

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ Google –¢–∞–±–ª–∏—Ü–µ
–í –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ (`MainSheet`) –¥–æ–ª–∂–Ω—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–Ω–∞–∑–≤–∞–Ω–∏—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ `config.py`):
- `–ò–º—è`, `–§–∞–º–∏–ª–∏—è`, `–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è`, `–î–æ–º–∞—à–∫–∞`, `–°—Ç–∞—Ç—É—Å`, `–§–æ—Ç–æ`.

–¢–∞–∫–∂–µ –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç –ª–∏—Å—Ç—ã:
- `Users`: –î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º.
- `AccessLog`: –î–ª—è –ª–æ–≥–æ–≤ –≤—Ö–æ–¥–∞.
- `ActionLog`: –î–ª—è –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –ª–æ–≥–æ–≤ –¥–µ–π—Å—Ç–≤–∏–π.

## üë• –ö–æ–Ω—Ç–∞–∫—Ç—ã
–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞: @Gosha_Lee
